<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${post != null} ? 'Edit Post' : 'Write a New Post'">Write a New Post</title>
    <style>
        body { font-family: sans-serif; }
        header { border-bottom: 1px solid #ccc; padding: 10px 0; }
        nav ul { list-style: none; padding: 0; margin: 0; display: flex; justify-content: center; }
        nav ul li { margin: 0 20px; }
        nav ul li a { text-decoration: none; color: #333; font-weight: bold; font-size: 18px; }
        nav ul li a:hover { color: #007bff; }
        .write-container { max-width: 800px; margin: 40px auto; padding: 20px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: bold; }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }
        .form-group textarea {
            height: 300px;
            resize: none;
            overflow-y: auto;
        }
        .submit-button {
            padding: 12px 25px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
    </style>
</head>
<body>

<header>
    <nav>
        <ul>
            <li><a th:href="@{/main}">MAIN</a></li>
            <li><a th:href="@{/hobby}">HOBBY</a></li>
            <li><a th:href="@{/study}">STUDY</a></li>
        </ul>
    </nav>
</header>

<div class="write-container">
    <form name="writeForm" th:action="${post != null} ? @{/study/{id}/edit(id=${post.id})} : @{/study/write}" method="post">
        <div class="form-group">
            <label for="title">제목</label>
            <input type="text" id="title" name="title" required
                   th:value="${post != null} ? ${post.title} : ''">
        </div>
        <div class="form-group">
            <label for="content">내용</label>
            <textarea id="content" name="content" required
                      th:text="${post != null} ? ${post.content} : ''"></textarea>
        </div>
        <div class="form-group">
            <label for="categoryId">카테고리 선택</label>
            <select id="categoryId" name="categoryId" onchange="toggleNewCategoryInput()" required>
                <option value="">-- 카테고리를 선택하세요 --</option>
                <option th:each="category : ${categories}"
                        th:value="${category.id}"
                        th:text="${category.name}"
                        th:selected="${post != null and post.categoryId == category.id}">Category Name</option>
                <option value="addNewCategory">-- 카테고리 추가 --</option>
            </select>
        </div>
        <div class="form-group" id="newCategorySection" style="display: none;">
            <label for="newCategoryName">새 카테고리 입력</label>
            <input type="text" id="newCategoryName" name="newCategoryName" placeholder="새로운 카테고리 이름을 입력하세요">
        </div>
        <button type="submit" class="submit-button"
                th:text="${post != null} ? '수정하기' : '저장하기'">저장하기</button>
    </form>
</div>

<script>
    function toggleNewCategoryInput() {
        const categorySelect = document.getElementById('categoryId');
        const newCategorySection = document.getElementById('newCategorySection');
        const newCategoryInput = document.getElementById('newCategoryName');

        if (categorySelect.value === 'addNewCategory') {
            newCategorySection.style.display = 'block';
            newCategoryInput.required = true;
            categorySelect.name = '';
        } else {
            newCategorySection.style.display = 'none';
            newCategoryInput.required = false;
            newCategoryInput.value = '';
            categorySelect.name = 'categoryId';
        }
    }
</script>

</body>
</html>